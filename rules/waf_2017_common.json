{
    "name":"Web Common Attack",
    "description":"Web常用攻击",
    "level":2,
    "status":"on",
    "author":"hamdell",
    "actions":[
        {
            "id":20170001,
            "msg":"OS Command Injection detected",
            "pattern":"(?:(?:[\\;\\|\\`]\\W*?\\bcc|\\b(wget|curl))\\b|\\/cc(?:[\\'\\\"\\|\\;\\`\\-\\s]|$))"
        },
        {
            "id":20170002,
            "msg":"SSI injection detected",
            "pattern":"<!--\\W*?#\\W*?(?:e(?:cho|xec)|printenv|include|cmd)"
        },
        {
            "id":20170003,
            "msg":"HTTP Response Splitting",
            "pattern":"[\\n\\r](?:content-(type|length)|set-cookie|location):"
        },
        {
            "id":20170004,
            "msg":"Remote File Inclusion - URL in request argument",
            "pattern":"^(?:ht|f)tps?:\\/\\/(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"
        },
        {
            "id":20170005,
            "msg":"Remote File Inclusion - RFI data ends with question mark",
            "pattern":"^(?:ft|htt)ps?(.*?)\\?+$"
        },
        {
            "id":20170006,
            "msg":"System command access attempt",
            "pattern":"\\b(?:(?:n(?:map|et|c)|w(?:guest|sh)|telnet|rcmd|ftp)\\.exe\\b|cmd(?:(?:32)?\\.exe\\b|\\b\\W*?\\/c))"
        },
        {
            "id":20170007,
            "msg":"System command injection attempt",
            "pattern":"(?:\\b(?:(?:n(?:et(?:\\b\\W+?\\blocalgroup|\\.exe)|(?:map|c)\\.exe)|t(?:racer(?:oute|t)|elnet\\.exe|clsh8?|ftp)|(?:w(?:guest|sh)|rcmd|ftp)\\.exe|echo\\b\\W*?\\by+)\\b|c(?:md(?:(?:\\.exe|32)\\b|\\b\\W*?\\/c)|d(?:\\b\\W*?[\\\\/]|\\W*?\\.\\.)|hmod.{0,40}?\\+.{0,3}x))|[\\;\\|\\`]\\W*?\\b(?:(?:c(?:h(?:grp|mod|own|sh)|md|pp)|p(?:asswd|ython|erl|ing|s)|n(?:asm|map|c)|f(?:inger|tp)|(?:kil|mai)l|(?:xte)?rm|ls(?:of)?|telnet|uname|echo|id)\\b|g(?:\\+\\+|cc\\b)))"
        },
        {
            "id":20170008,
            "msg":"SQL Comment Sequence",
            "pattern":"(/\\*!?|\\*/|[';]--|--[\\s\\r\\n\\v\\f]|(?:--[^-]*?-)|([^\\-&])#.*?[\\s\\r\\n\\v\\f]|;?\\\\x00)"
        },
        {
            "id":20170009,
            "msg":"OS Command Injection detected",
            "pattern":"'|(and|or)\\b.+?(>|<|=|\\bin|\\blike)|\\/\\*.+?\\*\\/|<\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)|(\\.\\.\\/)+|^\\/?[a-zA-Z]+(\\/[a-zA-Z]+)+$"
        },
        {
            "id":20170010,
            "msg":"SQL String Termination",
            "pattern":"(^[\\\"'`´’‘;]+|[\\\"'`´’‘;]+$)"
        },
        {
            "id":20170011,
            "msg":"SQL Injection payload",
            "pattern":"(?:(sleep\\((\\s*?)(\\d*?)(\\s*?)\\)|benchmark\\((.*?)\\,(.*?)\\)))"
        },
        {
            "id":20170012,
            "msg":"XSS (Cross-Site Scripting) - IE Filter",
            "pattern":"(?:<script.*?[ /+\\t]*?((src)|(xlink:href)|(href))[ /+\\t]*=)"
        },
        {
            "id":20170013,
            "msg":"XSS (Cross-Site Scripting) - JS Fragments",
            "pattern":"(fromcharcode|alert|eval)\\s*\\("
        },
        {
            "id":20170014,
            "msg":"XSS (Cross-Site Scripting) - xss testing alert",
            "pattern":"[/'\\\"<]xss[/'\\\">]"
        },
        {
            "id":20170015,
            "msg":"XSS (Cross-Site Scripting) - IE Filter",
            "pattern":"(?:<[i]?frame.*?[ /+\\t]*?src[ /+\\t]*=)"
        }
    ]
}
